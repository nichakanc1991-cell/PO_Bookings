<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>P.O. CAT HOTEL | ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡πÅ‡∏°‡∏ß</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --po-green: #0F3B2E;
      --po-cream: #F2E2C4;
      --po-gold: #D5B774;
    }
    body { background: #F7F6EE; font-family: "Prompt", sans-serif; }
    input, select { border: 1.5px solid var(--po-gold); }

    .popup-bg {
      position: fixed; inset: 0;
      background: rgba(15, 59, 46, 0.6);
      display: flex; align-items: center; justify-content: center;
      backdrop-filter: blur(3px);
      z-index: 50;
    }
    .popup-box {
      background: var(--po-cream);
      border: 3px solid var(--po-gold);
      border-radius: 1rem;
      padding: 2rem;
      max-width: 400px;
      color: var(--po-green);
      text-align: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn { from {opacity:0;transform:scale(0.9);} to {opacity:1;transform:scale(1);} }
    .popup-btn {
      background: var(--po-green);
      color: var(--po-cream);
      border-radius: 9999px;
      padding: 0.6rem 1.2rem;
      font-weight: 600;
      transition: all 0.3s;
    }
    .popup-btn:hover { background: #164D3D; }
  </style>
</head>

<body class="text-[var(--po-green)]">
  <header class="bg-[var(--po-green)] text-[var(--po-cream)] py-6 text-center">
    <h1 class="text-3xl font-bold">P.O. CAT HOTEL</h1>
    <p>Private & Premium Stay for Cats</p>
  </header>

  <section class="max-w-3xl mx-auto bg-white mt-6 rounded-3xl shadow-lg p-8 border-4 border-[var(--po-gold)]">
    <h2 class="text-2xl font-semibold mb-6">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>

    <form id="bookingForm" class="space-y-6">
      <div>
        <label class="block mb-2 font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</label>
        <input type="text" id="customerName" class="w-full rounded-lg p-2" required>
      </div>

      <div>
        <label class="block mb-2 font-semibold">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
        <input type="text" id="customerPhone" class="w-full rounded-lg p-2" required>
      </div>

      <div>
        <label class="block mb-2 font-semibold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</label>
        <select id="roomType" class="w-full rounded-lg p-2">
          <option value="standard">Standard Room (‡∏ø250/‡∏Ñ‡∏∑‡∏ô)</option>
          <option value="suite">Suite Room (‡∏ø500/‡∏Ñ‡∏∑‡∏ô)</option>
        </select>
      </div>

      <div id="catNamesContainer">
        <label class="block mb-2 font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å</label>
        <div id="catNameList" class="space-y-2">
          <input type="text" name="catName[]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà 1" class="w-full rounded-lg p-2">
        </div>
        <button type="button" id="addCatBtn" class="text-[var(--po-green)] underline mt-2">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß</button>
      </div>

      <div class="grid md:grid-cols-2 gap-6">
        <div>
          <label class="block mb-2 font-semibold">‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Å‡∏≠‡∏¥‡∏ô</label>
          <input type="date" id="checkinDate" class="w-full rounded-lg p-2 mb-2" required>
          <select id="checkinTime" class="w-full rounded-lg p-2">
  <option value="12">12:00</option>
  <option value="13">13:00</option>
  <option value="14">14:00</option>
  <option value="15">15:00</option>
  <option value="16">16:00</option>
  <option value="17">17:00</option>
  <option value="18">18:00</option>
  <option value="19">19:00</option>
  <option value="20">20:00</option>
  <option value="21">21:00</option>
  <option value="22">22:00</option>
  <option value="23">23:00</option>
  <option value="24">24:00</option>
          </select>
        </div>
        <div>
          <label class="block mb-2 font-semibold">‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Å‡πÄ‡∏≠‡∏≤‡∏ó‡πå</label>
          <input type="date" id="checkoutDate" class="w-full rounded-lg p-2 mb-2" required>
          <select id="checkoutTime" class="w-full rounded-lg p-2">
  <option value="12">12:00</option>
  <option value="13">13:00</option>
  <option value="14">14:00</option>
  <option value="15">15:00</option>
  <option value="16">16:00</option>
  <option value="17">17:00</option>
  <option value="18">18:00</option>
  <option value="19">19:00</option>
  <option value="20">20:00</option>
  <option value="21">21:00</option>
  <option value="22">22:00</option>
  <option value="23">23:00</option>
  <option value="24">24:00</option>
          </select>
        </div>
      </div>

      <div class="border-t pt-4 font-semibold">
        <p id="durationText"></p>
        <p>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="totalPrice">0</span> ‡∏ö‡∏≤‡∏ó</p>
        <p>‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%: <span id="depositAmount">0</span> ‡∏ö‡∏≤‡∏ó</p>
      </div>

      <button type="submit"
        class="w-full bg-[var(--po-green)] text-[var(--po-cream)] py-3 rounded-lg mt-6 hover:bg-[#164D3D] transition">
        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
      </button>
    </form>
  </section>

  <!-- Popup QR -->
  <div id="popup" class="popup-bg hidden">
    <div class="popup-box">
      <h3 class="text-xl font-bold mb-2">üíö ‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥</h3>
      <img src="qr.png" alt="QR" class="w-56 mx-auto rounded-lg mb-3">
      <p id="deposit-summary" class="text-lg font-semibold"></p>
      <a id="lineConfirm" target="_blank" class="popup-btn block mt-4">üí¨ ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡πÉ‡∏ô LINE</a>
      <button id="nextPage" class="popup-btn block mt-3 bg-[var(--po-gold)] text-[var(--po-green)]">‚û° ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>

  <script>
    const form = document.getElementById("bookingForm");
    const totalEl = document.getElementById("totalPrice");
    const depositEl = document.getElementById("depositAmount");
    const durationText = document.getElementById("durationText");
    const popup = document.getElementById("popup");
    const addCatBtn = document.getElementById("addCatBtn");
    const catNameList = document.getElementById("catNameList");

    // default ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("checkinDate").value = today;

    addCatBtn.addEventListener("click", () => {
      const count = catNameList.querySelectorAll("input").length + 1;
      const input = document.createElement("input");
      input.type = "text";
      input.name = "catName[]";
      input.placeholder = "‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà " + count;
      input.className = "w-full rounded-lg p-2 mt-1 transition duration-300 ease-in-out border border-[var(--po-gold)] focus:ring-2 focus:ring-[var(--po-green)]";
      catNameList.appendChild(input);
      input.scrollIntoView({behavior:"smooth",block:"center"});
    });

    function calculateTotal() {
  const room = form.roomType.value;
  const cats = catNameList.querySelectorAll("input").length;
  const checkinDateValue = form.checkinDate.value;
  const checkoutDateValue = form.checkoutDate.value;
  const checkinTimeValue = form.checkinTime.value;
  const checkoutTimeValue = form.checkoutTime.value;

  if (!checkinDateValue || !checkoutDateValue) return;
// ‚úÖ ‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
  const checkin = new Date(`${checkinDateValue}T${checkinTimeValue.padStart(2, "0")}:00:00`);
  const checkout = new Date(`${checkoutDateValue}T${checkoutTimeValue.padStart(2, "0")}:00:00`);
  const diffMs = checkout - checkin;
  const diffHours = diffMs / (1000 * 60 * 60);

  if (diffHours <= 0) {
    durationText.textContent = "";
    totalEl.textContent = 0;
    depositEl.textContent = 0;
    return;
  }

  // ‚úÖ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏£‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
  let rate;
  if (diffHours <= 3) {
    rate = room === "standard" ? 50 : 150;   // 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
  } else if (diffHours <= 12) {
    rate = room === "standard" ? 150 : 300;   // 12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
  } else {
    // ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 12 ‡∏ä‡∏°. ‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
    const days = Math.ceil(diffHours / 24);
    rate = (room === "standard" ? 250 : 500) * days;
  }

  // ‚úÖ ‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏°‡∏ß
  const total = rate * cats;
  const deposit = total * 0.5;

  // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
  durationText.textContent = `‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å: ${diffHours.toFixed(1)} ‡∏ä‡∏°. (${cats} ‡∏ï‡∏±‡∏ß)`;
  totalEl.textContent = total.toLocaleString();
  depositEl.textContent = deposit.toLocaleString();
}

    form.addEventListener("input", calculateTotal);
    ["checkinTime", "checkoutTime"].forEach(id => 
  document.getElementById(id).addEventListener("change", calculateTotal)
);


    form.addEventListener("submit", e => {
      e.preventDefault();
      const name = form.customerName.value.trim();
      const phone = form.customerPhone.value.trim();
      const room = form.roomType.value === "standard" ? "Standard Room" : "Suite Room";
      const catNames = [...catNameList.querySelectorAll("input")].map(i => i.value.trim()).filter(Boolean);
      const checkinDate = form.checkinDate.value;
      const checkoutDate = form.checkoutDate.value;
      const total = parseInt(totalEl.textContent);
      const deposit = parseInt(depositEl.textContent);

      if (catNames.length === 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏±‡∏ß");
      if (!/^[0-9]{9,10}$/.test(phone)) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
      if (!total || !deposit) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");

      const catsText = catNames.join(", ");
      const text = encodeURIComponent(`üìã ‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å PO CAT HOTEL\n‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á: ${name}\n‡πÄ‡∏ö‡∏≠‡∏£‡πå: ${phone}\n‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏ß: ${catsText}\n‡∏´‡πâ‡∏≠‡∏á: ${room}\n‡∏¢‡∏≠‡∏î‡∏°‡∏±‡∏î‡∏à‡∏≥: ${deposit} ‡∏ö‡∏≤‡∏ó`);
      document.getElementById("lineConfirm").href = `https://line.me/R/oaMessage/@po_grooming/?text=${text}`;
      document.getElementById("deposit-summary").innerHTML = `‡∏¢‡∏≠‡∏î‡∏°‡∏±‡∏î‡∏à‡∏≥: <b>${deposit} ‡∏ö‡∏≤‡∏ó</b>`;
      popup.classList.remove("hidden");

      document.getElementById("nextPage").onclick = () => {
        document.getElementById("nextPage").disabled = true;
        window.location.href = `receipt.html?name=${encodeURIComponent(name)}&phone=${phone}&room=${encodeURIComponent(room)}&cats=${encodeURIComponent(catsText)}&deposit=${deposit}&total=${total}&checkin=${checkinDate}&checkout=${checkoutDate}`;
      };
    });
  </script>
</body>
</html>
