<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏Å‡∏£‡∏π‡∏°‡∏°‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πÇ‡∏≠</title>

  <!-- Flatpickr (‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <!-- Tailwind + ‡∏ü‡∏≠‡∏ô‡∏ï‡πå -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{ --bg:#e8f1e6; --green:#0f5132; --cream:#f5e6c7; --brown:#7b5336; --brown-weak:#b58f74; --text:#263326; }
    html,body,*,button,input,select,textarea{ font-family:'Mitr',sans-serif!important; }
    body{ background:var(--bg); color:var(--text); }
    .card{ border:3px solid var(--green); border-radius:24px; background:#fefefeE6; backdrop-filter:blur(2px); }
    .ribbon{ background:var(--cream); color:var(--green); border:2px solid var(--green); border-radius:16px; }

    .slot{ background:var(--brown); color:var(--cream); border:2px solid #0001; box-shadow:0 6px 0 #0002; transition:.12s; }
    .slot:hover{ transform:translateY(-2px); box-shadow:0 8px 0 #0003; }
    .slot.disabled{ background:var(--brown-weak); opacity:.7; text-decoration:line-through; cursor:not-allowed; box-shadow:none; }

    /* ‡∏à‡∏∏‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ï‡πâ‡πÄ‡∏•‡∏Ç‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á Flatpickr */
    .flatpickr-day.has-dot{ position:relative; }
    .flatpickr-day.has-dot::after{
      content:""; width:6px; height:6px; position:absolute; left:50%; bottom:4px; transform:translateX(-50%); border-radius:9999px;
    }
    .flatpickr-day.dot-green::after  { background:#10b981; } /* ‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô */
    .flatpickr-day.dot-yellow::after { background:#f59e0b; } /* ‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á */
    .flatpickr-day.dot-red::after    { background:#ef4444; } /* ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô */
    .flatpickr-day.dot-gray::after   { background:#9ca3af; } /* ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• = ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á */
    .flatpickr-day.dot-gray{ color:#9ca3af!important; cursor:not-allowed; }
  </style>
</head>
<body>
  <header class="max-w-4xl mx-auto px-4 pt-8 text-center">
    <img src="logo-po.png" alt="PO Grooming Logo" class="mx-auto h-72 w-72 object-contain drop-shadow"/>
    <div class="inline-block ribbon px-5 py-2 mt-4 text-2xl md:text-4xl">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏û‡∏µ‡πÇ‡∏≠‡∏Å‡∏£‡∏π‡∏°‡∏°‡∏¥‡πà‡∏á</div>
  </header>

  <main class="max-w-4xl mx-auto mt-8 mb-16 px-4">
    <section class="card p-5 md:p-8">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div class="flex-1">
          <label class="block text-lg text-[color:var(--green)] mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</label>
          <input id="datePicker" type="text"
                 class="w-full rounded-xl border-2 border-[color:var(--green)] px-3 py-2 focus:outline-none focus:ring-4 focus:ring-green-200"/>
          <p class="text-sm text-[color:var(--green)]/80 mt-1">*‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏Å.‡∏¢.‚Äì‡∏ò.‡∏Ñ. 2568</p>
        </div>
        <a href="https://lin.ee/n5KyWC5" target="_blank"
           class="h-[42px] px-5 rounded-xl bg-[color:var(--cream)] text-[color:var(--green)] text-lg shadow border border-[color:var(--green)] hover:bg-[color:var(--green)] hover:text-[color:var(--cream)] flex items-center justify-center">
          ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
        </a>
      </div>

      <div class="mt-6 grid grid-cols-2 md:grid-cols-3 gap-4" id="slotGrid"></div>
      <p id="empty" class="text-center text-[color:var(--green)]/70 mt-8 hidden">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
      <p id="outOfRange" class="text-center text-red-700 mt-6 hidden">‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏Å.‡∏¢.‚Äì‡∏ò.‡∏Ñ. 2568 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
    </section>
  </main>

  <script>
    /* ===== ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ===== */
    const TIMES    = ["14:00","15:00","16:00","17:00","18:00","19:00"];
    const MIN_DATE = new Date("2025-09-01");
    const MAX_DATE = new Date("2025-12-31");

    /* ‚úÖ ‡∏•‡∏¥‡∏á‡∏Å‡πå CSV (Publish to web ‚Üí CSV) */
    const CSV_BASE = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1tTADklx6sJ4rLaiflR2VR4brc8WR38FsEp_M2Bf8hM0V9pBNmOrMJurEqAEfzOgNKbFc-_WuyaXF/pub?output=csv";
    const CSV_URL  = CSV_BASE + (CSV_BASE.includes("?") ? "&" : "?") + "t=" + Date.now(); // ‡∏Å‡∏±‡∏ô‡πÅ‡∏Ñ‡∏ä

    /* ===== ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á DOM ===== */
    const slotGrid = document.getElementById('slotGrid');
    const emptyEl  = document.getElementById('empty');
    const oorEl    = document.getElementById('outOfRange');
    const dateEl   = document.getElementById('datePicker');

    /* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ===== */
    let AVAIL_MAP  = {};  // {"YYYY-MM-DD": {"14:00": true/false, ...}}
    let DAY_STATUS = {};  // {"YYYY-MM-DD": "green" | "yellow" | "red"}
    let fp = null;        // flatpickr instance

    /* ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤ ===== */
    const toIsoDate = d => new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,10);
    const inRange   = d => (d >= MIN_DATE && d <= MAX_DATE);

    function toYMD(dateStr){
      const d = new Date(dateStr);
      if (isNaN(d)) return "";
      return toIsoDate(d);
    }
    function toHHMM(timeStr){
      const t = String(timeStr).trim();
      const m1 = t.match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);
      if (m1) return `${m1[1].padStart(2,"0")}:${m1[2].padStart(2,"0")}`;
      const m2 = t.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);
      if (m2){
        let h = parseInt(m2[1],10), m=m2[2], ap=m2[3].toUpperCase();
        if (ap==="PM" && h<12) h+=12;
        if (ap==="AM" && h===12) h=0;
        return `${String(h).padStart(2,"0")}:${m}`;
      }
      return t;
    }

    /* ===== ‡πÅ‡∏õ‡∏•‡∏á CSV ‚Üí list ===== */
    function parseCSV(text){
      const rows = text.trim().split(/\r?\n/).map(r => r.split(","));
      if (rows.length < 2) return [];
      const head = rows[0].map(h => h.trim());
      const norm = head.map(h => h.replace(/\s/g,'').toLowerCase());
      const iDate = norm.findIndex(h => ["date","‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà"].includes(h));
      const iTime = norm.findIndex(h => ["time","‡πÄ‡∏ß‡∏•‡∏≤"].includes(h));
      const iStat = norm.findIndex(h => ["status","‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"].includes(h));

      const out = [];
      for(let i=1;i<rows.length;i++){
        const r = rows[i];
        const rawDate = (r[iDate]||"").trim();
        const rawTime = (r[iTime]||"").trim();
        if (!rawDate || !rawTime) continue;

        const date = toYMD(rawDate);
        const time = toHHMM(rawTime);
        if (!date || !time) continue;

        const raw = ((iStat>=0 ? r[iStat] : "‡∏ß‡πà‡∏≤‡∏á")||"").trim().toLowerCase();
        const isFree = (raw==="true") || (raw==="‡∏ß‡πà‡∏≤‡∏á") || (raw==="1") || (raw==="yes");
        out.push({date,time,isFree});
      }
      return out;
    }

    function buildAvailMap(list){
      const map = {};
      list.forEach(({date,time,isFree})=>{
        if (!map[date]) map[date] = {};
        map[date][time] = !!isFree;
      });
      return map;
    }

    /* ===== ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á/‡πÅ‡∏î‡∏á) =====
       üü¶ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏≠: ‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô ‚Äú‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï‚Äù ‚Üí ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á)
    */
    function summarizeDayStatus(map){
      const out  = {};
      const slotsPerDay = TIMES.length;
      for (const [date, times] of Object.entries(map)){
        let free = 0;
        TIMES.forEach(t => { if (times[t]) free++; });
        out[date] = (free === 0) ? "red" : (free < slotsPerDay) ? "yellow" : "green";
      }
      return out; // ‡∏ß‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô out = ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• = ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á
    }

    /* ===== ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô (Flatpickr) ===== */
    function initCalendar(){
      if (fp){ fp.destroy(); fp = null; }

      fp = flatpickr("#datePicker", {
        dateFormat: "Y-m-d",
        defaultDate: dateEl.value || toIsoDate(new Date()),
        minDate: toIsoDate(MIN_DATE),
        maxDate: toIsoDate(MAX_DATE),
        disableMobile: true,
        // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        enable: [
          function(date){ return !!DAY_STATUS[toIsoDate(date)]; }
        ],
        onDayCreate(dObj, _str, _inst, dayElem){
          const iso = toIsoDate(dObj);
          if (!inRange(dObj)) return;
          const s = DAY_STATUS[iso];
          if (s){
            dayElem.classList.add("has-dot","dot-"+s);
          } else {
            // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Üí ‡∏à‡∏∏‡∏î‡πÄ‡∏ó‡∏≤ + ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            dayElem.classList.add("has-dot","dot-gray","flatpickr-disabled");
            dayElem.setAttribute("aria-disabled","true");
            dayElem.style.cursor = "not-allowed";
          }
        },
        onChange(selectedDates){
          if (!selectedDates.length) return;
          const iso = toIsoDate(selectedDates[0]);
          dateEl.value = iso;
          renderSlots(iso);
        }
      });

      // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≠‡∏á
      const keys = Object.keys(DAY_STATUS).sort();
      if (keys.length){
        if (!DAY_STATUS[dateEl.value]){
          dateEl.value = keys[0];
          fp.setDate(keys[0], true);
          renderSlots(keys[0]);
        }
      } else {
        // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏•‡∏¢
        dateEl.value = toIsoDate(MIN_DATE);
        renderSlots(dateEl.value);
      }
    }

    function refreshCalendarDots(){
      if (fp){
        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï enable ‡∏ï‡∏≤‡∏° DAY_STATUS ‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡πâ‡∏ß redraw
        fp.set('enable', [ (date)=> !!DAY_STATUS[toIsoDate(date)] ]);
        fp.redraw();
      }
    }

    /* ===== ‡∏ß‡∏≤‡∏î‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ===== */
    function renderSlots(dateStr){
      slotGrid.innerHTML = "";
      emptyEl.classList.add('hidden');

      const d = new Date(dateStr);
      if (!inRange(d)){ oorEl.classList.remove('hidden'); return; }
      oorEl.classList.add('hidden');

      const dayMap = AVAIL_MAP[dateStr] || null;

      // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏¢ = ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á
      if (!dayMap){
        emptyEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ";
        emptyEl.classList.remove('hidden');
        return;
      }

      let hasAny = false;
      TIMES.forEach(t=>{
        const isFree = !!dayMap[t]; // ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß: true = ‡∏ß‡πà‡∏≤‡∏á, false = ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á
        const btn = document.createElement('button');
        btn.className = "slot rounded-2xl px-4 py-5 text-center";
        btn.innerHTML = `
          <div class="text-base opacity-90 mb-1">${isFree ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á'}</div>
          <div class="font-medium text-2xl md:text-3xl">${t}</div>
        `;
        if (!isFree){ btn.classList.add('disabled'); btn.disabled = true; }
        slotGrid.appendChild(btn);
        hasAny = true;
      });

      if (!hasAny){
        emptyEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ";
        emptyEl.classList.remove('hidden');
      }
    }

    /* ===== ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á ===== */
    async function loadData(){
      try{
        const res  = await fetch(CSV_URL, { cache: "no-store" });
        const text = await res.text();
        const list = parseCSV(text);
        if (list.length) AVAIL_MAP = buildAvailMap(list);
      }catch(e){
        console.warn("‡πÇ‡∏´‡∏•‡∏î CSV ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ:", e);
        AVAIL_MAP = {}; // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• = ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
      }finally{
        DAY_STATUS = summarizeDayStatus(AVAIL_MAP);
        if (!fp) initCalendar(); else refreshCalendarDots();
        // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô input ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡∏ô
        const keys = Object.keys(DAY_STATUS).sort();
        if (keys.length && !DAY_STATUS[dateEl.value]){
          dateEl.value = keys[0];
          if (fp) fp.setDate(keys[0], true);
        }
        renderSlots(dateEl.value);
      }
    }

    /* ===== ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ===== */
    (function setDefaultDate(){
      const today = new Date();
      const d = (today < MIN_DATE || today > MAX_DATE) ? MIN_DATE : today;
      dateEl.value = toIsoDate(d);
    })();

    // ‡∏Å‡∏±‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏á
    dateEl.addEventListener('change', ()=>{
      const d = new Date(dateEl.value || "");
      if (!inRange(d)){
        alert("‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏Å.‡∏¢.‚Äì‡∏ò.‡∏Ñ. 2568 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
        dateEl.value = toIsoDate(MIN_DATE);
      }
      if (!DAY_STATUS[dateEl.value]){
        emptyEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ";
        emptyEl.classList.remove('hidden');
      } else {
        emptyEl.classList.add('hidden');
        renderSlots(dateEl.value);
        if (fp) fp.setDate(dateEl.value, true);
      }
    });

    loadData();
  </script>
</body>
</html>
